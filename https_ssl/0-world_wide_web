#!/usr/bin/env bash
# This script checks the DNS records for subdomains and displays information about them

# Check if domain is provided
if [ -z "$1" ]; then
  echo "Usage: $0 <domain> [subdomain]"
  exit 1
fi

domain=$1
subdomain=$2

# Function to audit DNS record of a subdomain
audit_subdomain() {
  local sub=$1
  local dom=$2
  result=$(dig +short "$sub.$dom" A)
  
  if [ -z "$result" ]; then
    echo "No A record found for $sub.$dom"
  else
    echo "The subdomain $sub is a A record and points to $result"
    
    # Additional validation for specific subdomains
    case $sub in
      www)
        if [ "$result" == "54.210.47.110" ]; then
          echo "Your subdomain www points to your lb-01 server IP"
        fi
        ;;
      web-01)
        if [ "$result" == "34.198.248.145" ]; then
          echo "Your subdomain web-01 points to your web-01 server IP"
        fi
        ;;
      web-02)
        if [ "$result" == "54.89.38.100" ]; then
          echo "Your subdomain web-02 points to your web-02 server IP"
        fi
        ;;
    esac
  fi
}

# If subdomain is provided, audit that subdomain
if [ -n "$subdomain" ]; then
  audit_subdomain "$subdomain" "$domain"
else
  # Otherwise, audit the default subdomains in a specific order
  for sub in www lb-01 web-01 web-02; do
    audit_subdomain "$sub" "$domain"
  done
fi
