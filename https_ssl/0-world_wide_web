#!/bin/bash

# Function to extract the A record of a subdomain
get_subdomain_ip() {
    subdomain=$1
    domain=$2
    dig +short "$subdomain.$domain" A
}

# Check if the domain parameter is provided
if [ -z "$1" ]; then
    echo "Please provide a domain name."
    exit 1
fi

domain=$1

# List of subdomains to check
subdomains=("www" "lb-01" "web-01" "web-02")

# If subdomain is passed, only check that specific subdomain
if [ -n "$2" ]; then
    subdomain=$2
    ip=$(get_subdomain_ip "$subdomain" "$domain")
    if [ -z "$ip" ]; then
        echo "No record found for $subdomain.$domain"
    else
        echo "The subdomain $subdomain is a A record and points to $ip"
    fi
    exit 0
fi

# Otherwise, loop through the predefined list of subdomains
for subdomain in "${subdomains[@]}"; do
    ip=$(get_subdomain_ip "$subdomain" "$domain")
    if [ -z "$ip" ]; then
        echo "No record found for $subdomain.$domain"
    else
        echo "The subdomain $subdomain is a A record and points to $ip"
    fi
done
